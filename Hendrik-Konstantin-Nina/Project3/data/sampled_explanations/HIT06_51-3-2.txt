1: I believe that the problem must be in the add method. I do not see the problem in the code that is shown. I think the problem might be in the maybeEndStatement method.
2: the exp variable not get the value is unusable function so the code not executed allways
3: Correct the while loop. The problem will be solved.
